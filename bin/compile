#!/usr/bin/env bash
# bin/compile <build-dir> <cache-dir>

echo "-----> Installing Ghostscript 10.03.1 using build directory $1"

BUILD_DIR=$1
BIN_DIR=$(dirname $0)  # Gets the directory where the script is located
BINARY="gs"
LOCATION="$BUILD_DIR/vendor/gs"

# Create the directory where Ghostscript will reside
mkdir -p $LOCATION/bin

# Copy the binary from the buildpack to the build directory
cp $BIN_DIR/$BINARY $LOCATION/bin/gs

echo "-----> Setting up Ghostscript runtime environment"

mkdir -p $BUILD_DIR/.profile.d
echo "export PATH=\"\$HOME/vendor/gs/bin:\$PATH\"" > $BUILD_DIR/.profile.d/ghostscript.sh